<Query>
    <Sql>
select
	distinct
		d.DiagnosisCode,
		line01.RecordConnectionIdentifier,
		line01.NHSNumber,
		line01.CDSActivityDate
from omop_staging.cds_diagnosis d
	inner join omop_staging.cds_line01 line01
		on d.MessageId = line01.MessageId
where line01.NHSNumber is not null;
	</Sql>
    <Explanation>
		<OmopColumnExplanation columnName="DiagnosisCode">ICD10 diagnosis code</OmopColumnExplanation>
		<OmopColumnExplanation columnName="RecordConnectionIdentifier">CDS specific identifier that binds multiple CDS messages together.</OmopColumnExplanation>
		<OmopColumnExplanation columnName="NHSNumber">Patient NHS Number</OmopColumnExplanation>
		<OmopColumnExplanation columnName="CDSActivityDate">Event date</OmopColumnExplanation>
	</Explanation>
</Query>