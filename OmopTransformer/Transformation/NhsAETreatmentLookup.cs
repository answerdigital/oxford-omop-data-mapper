using OmopTransformer.Annotations;

namespace OmopTransformer.Transformation;

[Description("Accident and Emergency Treatment to OMOP Procedure Concept IDs")]
internal class NhsAETreatmentLookup : ILookup
{
    public Dictionary<string, ValueWithNote> Mappings { get; } =      
        new()
        {
            { "01", new ValueWithNote("4080499", "Dressing") },
            { "011", new ValueWithNote("4080499", "Dressing - dressing minor wound/burn/eye") },
            { "012", new ValueWithNote("4080499", "Dressing - dressing major wound/burn") },
            { "02", new ValueWithNote("4080807", "Bandage") },
            { "03", new ValueWithNote("4147691", "Sutures") },
            { "031", new ValueWithNote("4147691", "Sutures - primary sutures") },
            { "032", new ValueWithNote("4147691", "Sutures - secondary/complex suture") },
            { "033", new ValueWithNote("4147691", "Sutures - removal of sutures/clips") },
            { "04", new ValueWithNote("42538257", "Wound Closure") },
            { "041", new ValueWithNote("4074344", "Wound Closure - steristrips") },
            { "042", new ValueWithNote("4141971", "Wound Closure - wound glue") },
            { "043", new ValueWithNote("42538257", "Wound Closure - other (e.g. clips)") },
            { "05", new ValueWithNote("4232206", "Plaster of Paris") },
            { "051", new ValueWithNote("4108844", "Plaster of Paris - application") },
            { "052", new ValueWithNote("4078743", "Plaster of Paris - removal") },
            { "06", new ValueWithNote("4194049", "Splint") },
            { "08", new ValueWithNote("4032408", "Removal") },
            { "09", new ValueWithNote("4080504", "Physiotherapy") },
            { "091", new ValueWithNote("4080504", "Physiotherapy - strapping, ultra sound treatment, short wave diathermy, manipulation") },
            { "092", new ValueWithNote("4218040", "Physiotherapy - gait re-education, falls prevention") },
            { "10", new ValueWithNote("4190331", "Manipulation") },
            { "101", new ValueWithNote("4042533", "Manipulation - manipulation of upper limb fracture") },
            { "102", new ValueWithNote("42709780", "Manipulation - manipulation of lower limb fracture") },
            { "103", new ValueWithNote("4190331", "Manipulation - manipulation of dislocation") },
            { "11", new ValueWithNote("4211374", "I&D") },
            { "12", new ValueWithNote("4311035", "IV Cannula") },
            { "13", new ValueWithNote("4041656", "Central Line") },
            { "14", new ValueWithNote("4178105", "Irrigation") },
            { "15", new ValueWithNote("4202832", "Intubation") },
            { "16", new ValueWithNote("44782942", "Chest Drain") },
            { "17", new ValueWithNote("4074328", "Urinary Catheter") },
            { "18", new ValueWithNote("4180456", "Defibrillation") },
            { "181", new ValueWithNote("4180456", "Defibrillation - defibrillation") },
            { "182", new ValueWithNote("4180456", "Defibrillation - external pacing") },
            { "19", new ValueWithNote("4205502", "CPR") },
            { "20", new ValueWithNote("46273093", "Minor Surgery") },
            { "21", new ValueWithNote("4304206", "Observation") },
            { "22", new ValueWithNote("4172321", "Guidance") },
            { "221", new ValueWithNote("4172321", "Guidance - written") },
            { "222", new ValueWithNote("4172321", "Guidance - verbal") },
            { "23", new ValueWithNote("4160439", "Anaesthesia") },
            { "231", new ValueWithNote("4174669", "Anaesthesia - general anaesthetic") },
            { "232", new ValueWithNote("4303995", "Anaesthesia - local anaesthetic") },
            { "233", new ValueWithNote("4117443", "Anaesthesia - regional block") },
            { "234", new ValueWithNote("4140470", "Anaesthesia - entonox") },
            { "235", new ValueWithNote("4219502", "Anaesthesia - sedation") },
            { "236", new ValueWithNote("4160439", "Anaesthesia - other") },
            { "24", new ValueWithNote("4293740", "Tetanus") },
            { "241", new ValueWithNote("4293740", "Tetanus - immune") },
            { "242", new ValueWithNote("4293740", "Tetanus - tetanus toxoid course") },
            { "243", new ValueWithNote("4293740", "Tetanus - tetanus toxoid booster") },
            { "244", new ValueWithNote("4037789", "Tetanus - human immunoglobulin") },
            { "245", new ValueWithNote("4250328", "Tetanus - combined tetanus/diphtheria course") },
            { "246", new ValueWithNote("4133518", "Tetanus - combined tetanus/diphtheria booster") },
            { "25", new ValueWithNote("44790388", "Nebuliser") },
            { "28", new ValueWithNote("4085113", "Thrombolysis") },
            { "281", new ValueWithNote("4018703", "Thrombolysis - streptokinase parenteral thrombolysis") },        
            { "282", new ValueWithNote("4085113", "Thrombolysis - recombinant") },
            { "283", new ValueWithNote("4241698", "Thrombolysis - plasminogen activator") },
            { "29", new ValueWithNote("4088217", "Parenteral Drugs") },
            { "291", new ValueWithNote("4161519", "Parenteral Drugs - intravenous drug, e.g. stat/bolus") },        
            { "292", new ValueWithNote("4030886", "Parenteral Drugs - intravenous infusion") },
            { "30", new ValueWithNote("4254901", "Vital Signs") },
            { "31", new ValueWithNote("4118442", "Burns Review") },
            { "32", new ValueWithNote("4079701", "X-ray Review") },
            { "33", new ValueWithNote("4295944", "Fracture Review") },
            { "34", new ValueWithNote("4075964", "Wound Cleaning") },
            { "35", new ValueWithNote("44793314", "Dressing/Wound Review") },
            { "36", new ValueWithNote("4180243", "Sling") },
            { "37", new ValueWithNote("4262407", "Epistaxis Control") },
            { "38", new ValueWithNote("4092976", "Nasal Airway") },
            { "39", new ValueWithNote("4339620", "Oral Airway") },
            { "40", new ValueWithNote("4239130", "Supplemental Oxygen") },
            { "41", new ValueWithNote("4306204", "Positive Pressure") },
            { "42", new ValueWithNote("4213288", "Arterial Line") },
            { "43", new ValueWithNote("763496", "Infusion Fluids") },
            { "44", new ValueWithNote("4024656", "Blood Transfusion") },
            { "45", new ValueWithNote("4149930", "Pericardiocentesis") },
            { "46", new ValueWithNote("4080549", "Lumbar Puncture") },
            { "47", new ValueWithNote("4170811", "Joint Aspiration") },
            { "48", new ValueWithNote("4083710", "Minor Plastic") },
            { "49", new ValueWithNote("4086432", "Rewarming") },
            { "50", new ValueWithNote("4086433", "Cooling") },
            { "51", new ValueWithNote("4162585", "Medication") },
            { "511", new ValueWithNote("4123242", "Medication - oral") },
            { "512", new ValueWithNote("4298276", "Medication - intra-muscular") },
            { "513", new ValueWithNote("4303435", "Medication - subcutaneous") },
            { "514", new ValueWithNote("4302260", "Medication - per rectum") },
            { "515", new ValueWithNote("4123242", "Medication - sublingual") },
            { "516", new ValueWithNote("4235706", "Medication - intra-nasal") },
            { "517", new ValueWithNote("4021805", "Medication - eye drops") },
            { "518", new ValueWithNote("4334396", "Medication - ear drops") },
            { "519", new ValueWithNote("4075356", "Medication - topical skin cream") },
            { "52", new ValueWithNote("4261887", "OT") },
            { "521", new ValueWithNote("4261887", "OT - OT functional assessment") },
            { "522", new ValueWithNote("4013690", "OT - OT activities of daily living equipment provision") },      
            { "53", new ValueWithNote("4083010", "Walking Aid Loan") },
            { "54", new ValueWithNote("44791868", "Social Work") },
            { "55", new ValueWithNote("4148277", "Eye") },
            { "551", new ValueWithNote("4148277", "Eye - orthoptic exercises") },
            { "552", new ValueWithNote("4162096", "Eye - laser of retina/iris or posterior capsule") },
            { "553", new ValueWithNote("4259619", "Eye - retrobulbar injection") },
            { "554", new ValueWithNote("4161695", "Eye - epilation of lashes") },
            { "555", new ValueWithNote("4252594", "Eye - subconjunctival injection") },
            { "56", new ValueWithNote("4305000", "Dental") },
            { "57", new ValueWithNote("4052492", "Prescription") },
            { "27", new ValueWithNote("", "Not Mappable") },
            { "99", new ValueWithNote("", "Not Mappable") },
        };


    public string[] ColumnNotes =>
    [
        "[ACCIDENT and EMERGENCY CLINICAL CODES](https://archive.datadictionary.nhs.uk/DD%20Release%20September%202020/supporting_information/accident_and_emergency_treatment_tables.html)",
        "[OMOP Procedures](https://athena.ohdsi.org/search-terms/terms?domain=Procedure&invalidReason=Valid&standardConcept=Standard&vocabulary=SNOMED&page=1&pageSize=15&query=)"
    ];
}
