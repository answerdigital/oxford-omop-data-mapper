{
  "omopTable": "Measurement",
  "origin": "SACT",
  "omopColumns": [
    {
      "name": "nhs_number",
      "operation_description": "Value copied from `NHS_Number`",
      "dataSource": [
        {
          "name": "NHS_Number",
          "description": "Patient NHS Number",
          "origins": [
            {
              "origin": "NHS NUMBER",
              "url": "https://www.datadictionary.nhs.uk/data_elements/nhs_number.html"
            }
          ]
        }
      ],
      "query": "\n\t\tselect distinct \n\t\t\tNHS_Number,\n\t\t\tWeight_At_Start_Of_Cycle,\n\t\t\tCASE\n\t\t\t\t-- Check for yyyy-MM-dd format (contains dash and year first)\n\t\t\t\tWHEN Start_Date_Of_Cycle LIKE '____-__-__' \n\t\t\t\t\tTHEN CAST(strptime(Start_Date_Of_Cycle, '%Y-%m-%d') AS TIMESTAMP)\n\t\t\t\t-- dd/MM/yyyy format, where day is between 1 and 31\n\t\t\t    WHEN Start_Date_Of_Cycle LIKE '__/__/____' AND CAST(substring(Start_Date_Of_Cycle, 1, 2) AS INTEGER) BETWEEN 1 AND 31\n\t\t\t\t    THEN CAST(strptime(Start_Date_Of_Cycle, '%d/%m/%Y') AS TIMESTAMP)\n\t\t\t\t-- Otherwise assume MM/dd/yyyy format\n\t\t\t\tWHEN Start_Date_Of_Cycle LIKE '__/__/____'\n\t\t\t\t\tTHEN CAST(strptime(Start_Date_Of_Cycle, '%m/%d/%Y') AS TIMESTAMP)\n\t\t\t\tELSE NULL\n\t\t\tEND AS Start_Date_Of_Cycle\n\t\tfrom omop_staging.sact_staging\n\t",
      "lookup_table_markdown": null
    },
    {
      "name": "measurement_date",
      "operation_description": "Converts text to dates.",
      "dataSource": [
        {
          "name": "Start_Date_Of_Cycle",
          "description": "Date the Cycle started",
          "origins": [
            {
              "origin": "START DATE OF CYCLE",
              "url": null
            }
          ]
        }
      ],
      "query": "\n\t\tselect distinct \n\t\t\tNHS_Number,\n\t\t\tWeight_At_Start_Of_Cycle,\n\t\t\tCASE\n\t\t\t\t-- Check for yyyy-MM-dd format (contains dash and year first)\n\t\t\t\tWHEN Start_Date_Of_Cycle LIKE '____-__-__' \n\t\t\t\t\tTHEN CAST(strptime(Start_Date_Of_Cycle, '%Y-%m-%d') AS TIMESTAMP)\n\t\t\t\t-- dd/MM/yyyy format, where day is between 1 and 31\n\t\t\t    WHEN Start_Date_Of_Cycle LIKE '__/__/____' AND CAST(substring(Start_Date_Of_Cycle, 1, 2) AS INTEGER) BETWEEN 1 AND 31\n\t\t\t\t    THEN CAST(strptime(Start_Date_Of_Cycle, '%d/%m/%Y') AS TIMESTAMP)\n\t\t\t\t-- Otherwise assume MM/dd/yyyy format\n\t\t\t\tWHEN Start_Date_Of_Cycle LIKE '__/__/____'\n\t\t\t\t\tTHEN CAST(strptime(Start_Date_Of_Cycle, '%m/%d/%Y') AS TIMESTAMP)\n\t\t\t\tELSE NULL\n\t\t\tEND AS Start_Date_Of_Cycle\n\t\tfrom omop_staging.sact_staging\n\t",
      "lookup_table_markdown": null
    },
    {
      "name": "measurement_datetime",
      "operation_description": "Converts text to dates.",
      "dataSource": [
        {
          "name": "Start_Date_Of_Cycle",
          "description": "Date the Cycle started",
          "origins": [
            {
              "origin": "START DATE OF CYCLE",
              "url": null
            }
          ]
        }
      ],
      "query": "\n\t\tselect distinct \n\t\t\tNHS_Number,\n\t\t\tWeight_At_Start_Of_Cycle,\n\t\t\tCASE\n\t\t\t\t-- Check for yyyy-MM-dd format (contains dash and year first)\n\t\t\t\tWHEN Start_Date_Of_Cycle LIKE '____-__-__' \n\t\t\t\t\tTHEN CAST(strptime(Start_Date_Of_Cycle, '%Y-%m-%d') AS TIMESTAMP)\n\t\t\t\t-- dd/MM/yyyy format, where day is between 1 and 31\n\t\t\t    WHEN Start_Date_Of_Cycle LIKE '__/__/____' AND CAST(substring(Start_Date_Of_Cycle, 1, 2) AS INTEGER) BETWEEN 1 AND 31\n\t\t\t\t    THEN CAST(strptime(Start_Date_Of_Cycle, '%d/%m/%Y') AS TIMESTAMP)\n\t\t\t\t-- Otherwise assume MM/dd/yyyy format\n\t\t\t\tWHEN Start_Date_Of_Cycle LIKE '__/__/____'\n\t\t\t\t\tTHEN CAST(strptime(Start_Date_Of_Cycle, '%m/%d/%Y') AS TIMESTAMP)\n\t\t\t\tELSE NULL\n\t\t\tEND AS Start_Date_Of_Cycle\n\t\tfrom omop_staging.sact_staging\n\t",
      "lookup_table_markdown": null
    },
    {
      "name": "measurement_type_concept_id",
      "operation_description": "Constant value set to `32828`. EHR episode record",
      "dataSource": null,
      "query": null,
      "lookup_table_markdown": null
    },
    {
      "name": "value_source_value",
      "operation_description": "Value copied from `Weight_At_Start_Of_Cycle`",
      "dataSource": [
        {
          "name": "Weight_At_Start_Of_Cycle",
          "description": "Weight when the cycle started",
          "origins": [
            {
              "origin": "WEIGHT AT START OF CYCLE",
              "url": null
            }
          ]
        }
      ],
      "query": "\n\t\tselect distinct \n\t\t\tNHS_Number,\n\t\t\tWeight_At_Start_Of_Cycle,\n\t\t\tCASE\n\t\t\t\t-- Check for yyyy-MM-dd format (contains dash and year first)\n\t\t\t\tWHEN Start_Date_Of_Cycle LIKE '____-__-__' \n\t\t\t\t\tTHEN CAST(strptime(Start_Date_Of_Cycle, '%Y-%m-%d') AS TIMESTAMP)\n\t\t\t\t-- dd/MM/yyyy format, where day is between 1 and 31\n\t\t\t    WHEN Start_Date_Of_Cycle LIKE '__/__/____' AND CAST(substring(Start_Date_Of_Cycle, 1, 2) AS INTEGER) BETWEEN 1 AND 31\n\t\t\t\t    THEN CAST(strptime(Start_Date_Of_Cycle, '%d/%m/%Y') AS TIMESTAMP)\n\t\t\t\t-- Otherwise assume MM/dd/yyyy format\n\t\t\t\tWHEN Start_Date_Of_Cycle LIKE '__/__/____'\n\t\t\t\t\tTHEN CAST(strptime(Start_Date_Of_Cycle, '%m/%d/%Y') AS TIMESTAMP)\n\t\t\t\tELSE NULL\n\t\t\tEND AS Start_Date_Of_Cycle\n\t\tfrom omop_staging.sact_staging\n\t",
      "lookup_table_markdown": null
    },
    {
      "name": "measurement_concept_id",
      "operation_description": "Constant value set to `4099154`. Body Weight",
      "dataSource": null,
      "query": null,
      "lookup_table_markdown": null
    },
    {
      "name": "value_as_number",
      "operation_description": "Converts text to number.",
      "dataSource": [
        {
          "name": "Weight_At_Start_Of_Cycle",
          "description": "Weight when the cycle started",
          "origins": [
            {
              "origin": "WEIGHT AT START OF CYCLE",
              "url": null
            }
          ]
        }
      ],
      "query": "\n\t\tselect distinct \n\t\t\tNHS_Number,\n\t\t\tWeight_At_Start_Of_Cycle,\n\t\t\tCASE\n\t\t\t\t-- Check for yyyy-MM-dd format (contains dash and year first)\n\t\t\t\tWHEN Start_Date_Of_Cycle LIKE '____-__-__' \n\t\t\t\t\tTHEN CAST(strptime(Start_Date_Of_Cycle, '%Y-%m-%d') AS TIMESTAMP)\n\t\t\t\t-- dd/MM/yyyy format, where day is between 1 and 31\n\t\t\t    WHEN Start_Date_Of_Cycle LIKE '__/__/____' AND CAST(substring(Start_Date_Of_Cycle, 1, 2) AS INTEGER) BETWEEN 1 AND 31\n\t\t\t\t    THEN CAST(strptime(Start_Date_Of_Cycle, '%d/%m/%Y') AS TIMESTAMP)\n\t\t\t\t-- Otherwise assume MM/dd/yyyy format\n\t\t\t\tWHEN Start_Date_Of_Cycle LIKE '__/__/____'\n\t\t\t\t\tTHEN CAST(strptime(Start_Date_Of_Cycle, '%m/%d/%Y') AS TIMESTAMP)\n\t\t\t\tELSE NULL\n\t\t\tEND AS Start_Date_Of_Cycle\n\t\tfrom omop_staging.sact_staging\n\t",
      "lookup_table_markdown": null
    },
    {
      "name": "unit_concept_id",
      "operation_description": "Constant value set to `9529`. Kg",
      "dataSource": null,
      "query": null,
      "lookup_table_markdown": null
    }
  ]
}