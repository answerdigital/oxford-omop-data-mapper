{
  "omopTable": "Observation",
  "origin": "SACT",
  "omopColumns": [
    {
      "name": "nhs_number",
      "operation_description": "Value copied from `NHSNumber`",
      "dataSource": [
        {
          "name": "NHSNumber",
          "description": "Patient NHS Number",
          "origins": [
            {
              "origin": "NHS NUMBER",
              "url": "https://www.datadictionary.nhs.uk/data_elements/nhs_number.html"
            }
          ]
        }
      ],
      "query": "\n\t\tselect\n\t\t\tdistinct\n  \t\t\treplace(NHS_Number, ' ', '') as NHSNumber,\n      \t\tClinical_Trial,\n\t\t\tCase \n\t\t\t\tWhen Clinical_Trial = 1 then concat(Clinical_Trial, ' - PATIENT is taking part in a CLINICAL TRIAL')\n\t\t\telse '' end as Source_Value,\n\t\t  \tCASE\n\t\t\t\t-- Check for yyyy-MM-dd format (contains dash and year first)\n\t\t\t\tWHEN Administration_Date LIKE '____-__-__' \n\t\t\t\t\tTHEN CAST(strptime(Administration_Date, '%Y-%m-%d') AS TIMESTAMP)\n\t\t\t\t-- dd/MM/yyyy format, where day is between 1 and 31\n\t\t\t    WHEN Administration_Date LIKE '__/__/____' AND CAST(substring(Administration_Date, 1, 2) AS INTEGER) BETWEEN 1 AND 31\n\t\t\t\t    THEN CAST(strptime(Administration_Date, '%d/%m/%Y') AS TIMESTAMP)\n\t\t\t\t-- Otherwise assume MM/dd/yyyy format\n\t\t\t\tWHEN Administration_Date LIKE '__/__/____'\n\t\t\t\t\tTHEN CAST(strptime(Administration_Date, '%m/%d/%Y') AS TIMESTAMP)\n\t\t\t\tELSE NULL\n\t\t\tEND AS Administration_Date\n\t\tfrom omop_staging.sact_staging\n  \t\twhere Clinical_Trial = '1'\n\t",
      "lookup_table_markdown": null
    },
    {
      "name": "observation_concept_id",
      "operation_description": "Constant value set to `4002165`. Clinical trial",
      "dataSource": null,
      "query": null,
      "lookup_table_markdown": null
    },
    {
      "name": "observation_date",
      "operation_description": "Converts text to dates.",
      "dataSource": [
        {
          "name": "Administration_Date",
          "description": "SYSTEMIC ANTI-CANCER THERAPY ADMINISTRATION DATE is the date of the Systemic Anti-Cancer Therapy Drug Administration or the date an oral drug was initially dispensed to the PATIENT.",
          "origins": [
            {
              "origin": "SYSTEMIC ANTI-CANCER THERAPY ADMINISTRATION DATE",
              "url": "https://www.datadictionary.nhs.uk/data_elements/systemic_anti-cancer_therapy_administration_date.html"
            }
          ]
        }
      ],
      "query": "\n\t\tselect\n\t\t\tdistinct\n  \t\t\treplace(NHS_Number, ' ', '') as NHSNumber,\n      \t\tClinical_Trial,\n\t\t\tCase \n\t\t\t\tWhen Clinical_Trial = 1 then concat(Clinical_Trial, ' - PATIENT is taking part in a CLINICAL TRIAL')\n\t\t\telse '' end as Source_Value,\n\t\t  \tCASE\n\t\t\t\t-- Check for yyyy-MM-dd format (contains dash and year first)\n\t\t\t\tWHEN Administration_Date LIKE '____-__-__' \n\t\t\t\t\tTHEN CAST(strptime(Administration_Date, '%Y-%m-%d') AS TIMESTAMP)\n\t\t\t\t-- dd/MM/yyyy format, where day is between 1 and 31\n\t\t\t    WHEN Administration_Date LIKE '__/__/____' AND CAST(substring(Administration_Date, 1, 2) AS INTEGER) BETWEEN 1 AND 31\n\t\t\t\t    THEN CAST(strptime(Administration_Date, '%d/%m/%Y') AS TIMESTAMP)\n\t\t\t\t-- Otherwise assume MM/dd/yyyy format\n\t\t\t\tWHEN Administration_Date LIKE '__/__/____'\n\t\t\t\t\tTHEN CAST(strptime(Administration_Date, '%m/%d/%Y') AS TIMESTAMP)\n\t\t\t\tELSE NULL\n\t\t\tEND AS Administration_Date\n\t\tfrom omop_staging.sact_staging\n  \t\twhere Clinical_Trial = '1'\n\t",
      "lookup_table_markdown": null
    },
    {
      "name": "observation_datetime",
      "operation_description": "Combines a date with a time of day.",
      "dataSource": [
        {
          "name": "Administration_Date",
          "description": "SYSTEMIC ANTI-CANCER THERAPY ADMINISTRATION DATE is the date of the Systemic Anti-Cancer Therapy Drug Administration or the date an oral drug was initially dispensed to the PATIENT.",
          "origins": [
            {
              "origin": "SYSTEMIC ANTI-CANCER THERAPY ADMINISTRATION DATE",
              "url": "https://www.datadictionary.nhs.uk/data_elements/systemic_anti-cancer_therapy_administration_date.html"
            }
          ]
        },
        {
          "name": "Administration_Date",
          "description": "SYSTEMIC ANTI-CANCER THERAPY ADMINISTRATION DATE is the date of the Systemic Anti-Cancer Therapy Drug Administration or the date an oral drug was initially dispensed to the PATIENT.",
          "origins": [
            {
              "origin": "SYSTEMIC ANTI-CANCER THERAPY ADMINISTRATION DATE",
              "url": "https://www.datadictionary.nhs.uk/data_elements/systemic_anti-cancer_therapy_administration_date.html"
            }
          ]
        }
      ],
      "query": "\n\t\tselect\n\t\t\tdistinct\n  \t\t\treplace(NHS_Number, ' ', '') as NHSNumber,\n      \t\tClinical_Trial,\n\t\t\tCase \n\t\t\t\tWhen Clinical_Trial = 1 then concat(Clinical_Trial, ' - PATIENT is taking part in a CLINICAL TRIAL')\n\t\t\telse '' end as Source_Value,\n\t\t  \tCASE\n\t\t\t\t-- Check for yyyy-MM-dd format (contains dash and year first)\n\t\t\t\tWHEN Administration_Date LIKE '____-__-__' \n\t\t\t\t\tTHEN CAST(strptime(Administration_Date, '%Y-%m-%d') AS TIMESTAMP)\n\t\t\t\t-- dd/MM/yyyy format, where day is between 1 and 31\n\t\t\t    WHEN Administration_Date LIKE '__/__/____' AND CAST(substring(Administration_Date, 1, 2) AS INTEGER) BETWEEN 1 AND 31\n\t\t\t\t    THEN CAST(strptime(Administration_Date, '%d/%m/%Y') AS TIMESTAMP)\n\t\t\t\t-- Otherwise assume MM/dd/yyyy format\n\t\t\t\tWHEN Administration_Date LIKE '__/__/____'\n\t\t\t\t\tTHEN CAST(strptime(Administration_Date, '%m/%d/%Y') AS TIMESTAMP)\n\t\t\t\tELSE NULL\n\t\t\tEND AS Administration_Date\n\t\tfrom omop_staging.sact_staging\n  \t\twhere Clinical_Trial = '1'\n\t",
      "lookup_table_markdown": null
    },
    {
      "name": "observation_type_concept_id",
      "operation_description": "Constant value set to `32818`. EHR administration record",
      "dataSource": null,
      "query": null,
      "lookup_table_markdown": null
    },
    {
      "name": "observation_source_value",
      "operation_description": "Value copied from `Source_value`",
      "dataSource": [
        {
          "name": "Source_value",
          "description": "Source value for the Systemic Anti-Cancer Therapy Data Set, CLINICAL TRIAL INDICATOR identifies if a PATIENT  is currently in an active Systemic Anti-Cancer Therapy CLINICAL TRIAL",
          "origins": [
            {
              "origin": "CLINICAL TRIAL INDICATOR",
              "url": "https://www.datadictionary.nhs.uk/data_elements/clinical_trial_indicator.html"
            }
          ]
        }
      ],
      "query": "\n\t\tselect\n\t\t\tdistinct\n  \t\t\treplace(NHS_Number, ' ', '') as NHSNumber,\n      \t\tClinical_Trial,\n\t\t\tCase \n\t\t\t\tWhen Clinical_Trial = 1 then concat(Clinical_Trial, ' - PATIENT is taking part in a CLINICAL TRIAL')\n\t\t\telse '' end as Source_Value,\n\t\t  \tCASE\n\t\t\t\t-- Check for yyyy-MM-dd format (contains dash and year first)\n\t\t\t\tWHEN Administration_Date LIKE '____-__-__' \n\t\t\t\t\tTHEN CAST(strptime(Administration_Date, '%Y-%m-%d') AS TIMESTAMP)\n\t\t\t\t-- dd/MM/yyyy format, where day is between 1 and 31\n\t\t\t    WHEN Administration_Date LIKE '__/__/____' AND CAST(substring(Administration_Date, 1, 2) AS INTEGER) BETWEEN 1 AND 31\n\t\t\t\t    THEN CAST(strptime(Administration_Date, '%d/%m/%Y') AS TIMESTAMP)\n\t\t\t\t-- Otherwise assume MM/dd/yyyy format\n\t\t\t\tWHEN Administration_Date LIKE '__/__/____'\n\t\t\t\t\tTHEN CAST(strptime(Administration_Date, '%m/%d/%Y') AS TIMESTAMP)\n\t\t\t\tELSE NULL\n\t\t\tEND AS Administration_Date\n\t\tfrom omop_staging.sact_staging\n  \t\twhere Clinical_Trial = '1'\n\t",
      "lookup_table_markdown": null
    }
  ]
}